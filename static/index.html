<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Project 4869 Panel</title>
    <style>
        body { font-family: sans-serif; background: #121212; color: #eee; margin: 0; display: flex; height: 100vh; }
        .sidebar { width: 300px; background: #1e1e1e; padding: 20px; border-right: 1px solid #333; }
        .main { flex: 1; display: flex; flex-direction: column; padding: 20px; }
        .log-box { flex: 1; background: #000; color: #00ff00; padding: 15px; font-family: monospace; overflow-y: auto; border-radius: 5px; line-height: 1.5; }
        input { width: 100%; padding: 10px; margin: 10px 0; background: #333; border: 1px solid #444; color: white; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: #ce1212; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; margin-bottom: 10px; }
        button:hover { background: #ff1e1e; }
    </style>
</head>
<body>
    <div class="sidebar">
        <h2>ğŸ•µï¸ è®¾ç½®</h2>
        <label>CD2 Token</label>
        <input type="password" id="cd2" placeholder="å¡«å…¥ API Token">
        <label>Emby URL</label>
        <input type="text" id="emby" placeholder="http://ip:8096">
        <button onclick="saveConfig()">ä¿å­˜é…ç½®</button>
        <hr style="border-top:1px solid #333; margin: 20px 0;">
        <button onclick="runTask()" style="background:#0056b3">æ‰‹åŠ¨å¯åŠ¨æŠ“å–</button>
    </div>
    <div class="main">
        <h2>å®æ—¶æ—¥å¿—</h2>
        <div class="log-box" id="logBox">ç­‰å¾…ç³»ç»Ÿå“åº”...</div>
    </div>
    <script>
        const logBox = document.getElementById('logBox');
        const es = new EventSource('/api/logs');
        es.onmessage = (e) => {
            const div = document.createElement('div');
            div.textContent = `[${new Date().toLocaleTimeString()}] ${e.data}`;
            logBox.appendChild(div);
            logBox.scrollTop = logBox.scrollHeight;
        };

        function saveConfig() {
            const data = { cd2_token: document.getElementById('cd2').value, emby_url: document.getElementById('emby').value };
            fetch('/api/config', { method: 'POST', body: JSON.stringify(data) }).then(() => alert("é…ç½®å·²åº”ç”¨"));
        }

        function runTask() {
            fetch('/api/run', { method: 'POST' });
        }
    </script>
</body>
</html>